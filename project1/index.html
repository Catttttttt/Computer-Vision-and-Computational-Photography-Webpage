<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS 180 Fall 23 Project 1</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #333;
        }
        h1 {
            margin-bottom: 10px;
        }
        h2 {
            margin-top: 30px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .reference-images, .example-images {
            margin-top: 20px;
        }
        pre {
            background: #eee;
            padding: 10px;
            overflow-x: auto;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>CS 180 Fall 23 Project 1: Colorizing the Prokudin-Gorskii photos</h1>
        <p><strong>By:</strong> Ekansh Agrawal</p>

        <h2>Project Description</h2>
        <p>The goal of this assignment was to take the digitized Prokudin-Gorskii glass plate images and, using image processing techniques, automatically produce a color image with as few visual artifacts as possible. In order to do this, I needed to extract the three color channel images, place them on top of each other, and align them so that they form a single RGB color image.</p>

        <h2>Algorithm Implementation</h2>
        <h3>Vanilla Search</h3>
        <p>For smaller images, the easiest approach was to define a search radius of 20 pixels in every direction. For every image, I fixed the blue channel and aligned the green and red channels separately.</p>
        <p>For aligning, I shift the channels through every possible combination and ascertain the similarity by computing a normalized cross correlation between the reference frame and the shifted channel. I keep the shift with the highest similarity score.</p>
        <p>I then perform all the necessary steps and return the stacked image.</p>

        <h3>Pyramid Search</h3>
        <p>For larger images, determining the search radius becomes difficult. I scale the image down by a power of 2 a few times. I repeat the vanilla search on the smaller scaled images, and use this alignment as a starting point for the next search, reducing the runtime significantly.</p>

        <h2>Results on Reference Images</h2>
        <div class="reference-images">
            <pre>
                church.jpg        used pyramid method with g: (-1, 6) r: (5, 0)
                tobolsk.jpg       used vanilla method with g: (0, 1) r: (0, 5)
                three_generations.jpg used pyramid method with g: (-6, 15) r: (-7, 10)
                melons.jpg        used pyramid method with g: (17, 10) r: (51, 15)
                cathedral.jpg     used vanilla method with g: (0, -3) r: (2, 0)
                onion_church.jpg  used pyramid method with g: (-11, 30) r: (-16, 41)
                train.jpg         used pyramid method with g: (-1, 14) r: (-2, 41)
                emir.jpg          used pyramid method with g: (1, 47) r: (12, 62)
                icon.jpg          used pyramid method with g: (40, 26) r: (90, 5)
                sculpture.jpg     used pyramid method with g: (-1, -6) r: (55, -6)
                lady.jpg          used pyramid method with g: (-1, 11) r: (0, 25)
                harvesters.jpg    used pyramid method with g: (17, 20) r: (39, 46)
                self_portrait.jpg used pyramid method with g: (6, 31) r: (33, 41)
                monastery.jpg     used vanilla method with g: (-7, 0) r: (-5, -2)
            </pre>
        </div>

        <h2>Results on Example Images</h2>
        <div class="example-images">
            <pre>
                master-pnp-prok-00100-00171u.jpg used pyramid method with g: (-6, -5) r: (-12, 57)
                master-pnp-prok-00200-00220u.jpg used pyramid method with g: (-5, -10) r: (6, -4)
            </pre>
        </div>

        <h2>Bells and Whistles</h2>
        <h3>Automatic Center Cropping</h3>
        <p>For larger images, instead of shifting the entire image, we first crop the image and take only the center half. We then perform the pyramid alignment on this cropped image. After obtaining the shift, we apply it to the entire frame.</p>

        <h2>Shortcomings</h2>
        <p>Some frames have empty pixels, leading to color bands that don't belong. Additionally, aligning all images perfectly would require rotation and perspective skew algorithms, which are more complex to implement.</p>
    </div>

</body>
</html>
